<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 计算机图形学 · Persuing</title><meta name="description" content="计算机图形学 - Persuing"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://Persuingsdu.github.io/atom.xml" title="Persuing"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">计算机图形学</h1><div class="post-info">Mar 11, 2018</div><div class="post-content"><p><strong>Bresenham算法</strong><br><a href="https://segmentfault.com/a/1190000002700500#articleHeader1" target="_blank" rel="external">主要参考</a><br><figure class="highlight c++"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GL/glut.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> GLfloat d = <span class="number">0.04</span>;</div><div class="line"><span class="comment">//布局网格线 25*25</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_line</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> i;</div><div class="line">	<span class="keyword">for</span> (i = <span class="number">-25</span>; i &lt; <span class="number">25</span>; i++) &#123;</div><div class="line">		<span class="comment">//垂线</span></div><div class="line">		glBegin(GL_LINES);</div><div class="line">		glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">		glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</div><div class="line">		glLineWidth(<span class="number">2</span>);</div><div class="line">		glVertex2f(i*d, <span class="number">-25</span>); </div><div class="line">		glVertex2f(i*d, <span class="number">25</span>);</div><div class="line">		glEnd();</div><div class="line">		<span class="comment">//水平</span></div><div class="line">		glBegin(GL_LINES);</div><div class="line">		glLineWidth(<span class="number">2</span>);</div><div class="line">		glVertex2f(<span class="number">-25</span>, i*d); </div><div class="line">		glVertex2f(<span class="number">25</span>, i*d);</div><div class="line">		glEnd();</div><div class="line">		glFlush();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//涂色</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">put_rect</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	glRectf(x*d, y*d, (x + <span class="number">1</span>)*d, (y + <span class="number">1</span>)*d);</div><div class="line">&#125;</div><div class="line"><span class="comment">//画线</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bresenham</span><span class="params">(<span class="keyword">int</span> xf,<span class="keyword">int</span> yf,<span class="keyword">int</span> xt,<span class="keyword">int</span> yt)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> i, j;</div><div class="line">	<span class="comment">//根据坐标画出直线</span></div><div class="line">	glBegin(GL_LINES);</div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	glLineWidth(<span class="number">2</span>);</div><div class="line">	glVertex2f(xf*d, yf*d); <span class="comment">//定点坐标范围</span></div><div class="line">	glVertex2f(xt*d, yt*d);</div><div class="line">	glEnd();</div><div class="line">	draw_line();<span class="comment">//网格</span></div><div class="line">	<span class="comment">//Bresenham算法进行涂色</span></div><div class="line">	<span class="keyword">if</span> (xf &gt; xt) &#123;</div><div class="line">		<span class="keyword">int</span> t;</div><div class="line">		t = xf; xf = xt; xt = t;</div><div class="line">		t = yf; yf = yt; yt = t;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> dx = xt - xf;</div><div class="line">	<span class="keyword">int</span> dy = yt - yf;</div><div class="line">	<span class="keyword">int</span> f = <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span> (dy &gt;= <span class="number">0</span> &amp;&amp; dy &lt;= dx) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = xf, y = yf; x &lt;= xt; x++) &#123;</div><div class="line">			put_rect(x, y);</div><div class="line">			<span class="keyword">if</span> ((f + dy) + (f + dy - dx) &lt; <span class="number">0</span>)</div><div class="line">				f += dy;</div><div class="line">			<span class="keyword">else</span> &#123; f += dy - dx; y++; &#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (dy &gt;= <span class="number">0</span> &amp;&amp; dy &gt; dx) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = xf, y = yf; y &lt;= yt; y++) &#123;</div><div class="line">			put_rect(x, y);</div><div class="line">			<span class="keyword">if</span> ((f - dx) + (f - dx + dy) &gt; <span class="number">0</span>)</div><div class="line">				f += -dx;</div><div class="line">			<span class="keyword">else</span> &#123; f += -dx + dy; x++; &#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (dy &lt;= <span class="number">0</span> &amp;&amp; -dy &lt;= dx) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = xf, y = yf; x &lt;= xt; x++) &#123;</div><div class="line">			put_rect(x, y);</div><div class="line">			<span class="keyword">if</span> ((f + dy) + (f + dy + dx) &gt; <span class="number">0</span>)</div><div class="line">				f += dy;</div><div class="line">			<span class="keyword">else</span> &#123; f += dy + dx; y--; &#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (dy &lt;= <span class="number">0</span> &amp;&amp; -dy &gt; dx) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = xf, y = yf; y &gt;= yt; y--) &#123;</div><div class="line">			put_rect(x, y);</div><div class="line">			<span class="keyword">if</span> ((f + dx) + (f + dy + dx) &lt; <span class="number">0</span>)</div><div class="line">				f += dx;</div><div class="line">			<span class="keyword">else</span> &#123; f += dy + dx; x++; &#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">	bresenham(<span class="number">-10</span>,<span class="number">-18</span>,<span class="number">20</span>, <span class="number">18</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="comment">//初始化opengl工具箱函数库</span></div><div class="line">	glutInit(&amp;argc, argv);</div><div class="line">	<span class="comment">//设置RGB色彩模式与单缓冲绘图模式</span></div><div class="line">	glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);</div><div class="line">	<span class="comment">//设置图像显示窗口的左上角位置(0,0)</span></div><div class="line">	glutInitWindowPosition(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">	<span class="comment">//设置窗口大小(600,600)</span></div><div class="line">	glutInitWindowSize(<span class="number">600</span>, <span class="number">600</span>);</div><div class="line">	<span class="comment">//设置窗口标题</span></div><div class="line">	glutCreateWindow(<span class="string">"Bressenham"</span>);</div><div class="line">	glClearColor(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>);</div><div class="line">	<span class="comment">//设置当前清除颜色</span></div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	<span class="comment">//设置主程序循环显示过程中所调用的显示函数</span></div><div class="line">	<span class="comment">//dispaly，表示取得函数名所对应的地址（函数地址）</span></div><div class="line">	glutDisplayFunc(&amp;display);</div><div class="line">	<span class="comment">//程序主循环</span></div><div class="line">	glutMainLoop();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行结果：<br><img src="/img/画线.png" alt="画线"><br><strong>Liang-Barsky剪裁算法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">"GL\glut.h"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Height 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Width 200</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> StartX 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> StartY 150</span></div><div class="line">GLint S[<span class="number">4</span>], f, N[<span class="number">4</span>];</div><div class="line"><span class="keyword">float</span> u1 = <span class="number">0</span>, u2 = <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawRect</span><span class="params">()</span> </span>&#123;</div><div class="line">	glColor3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);</div><div class="line">	glBegin(GL_QUADS);</div><div class="line">	glVertex2f(StartX, StartY);</div><div class="line">	glVertex2f(StartX + Width, StartY);</div><div class="line">	glVertex2f(StartX + Width, StartY + Height);</div><div class="line">	glVertex2f(StartX, StartY + Height);</div><div class="line">	glEnd();</div><div class="line">	glFlush();</div><div class="line">&#125;</div><div class="line"><span class="comment">//布局</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitEnvironment</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	glClearColor(<span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0</span>);</div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	glPointSize(<span class="number">6</span>);</div><div class="line">	glMatrixMode(GL_MODELVIEW);</div><div class="line">	glLoadIdentity();</div><div class="line">	gluOrtho2D(<span class="number">0</span>, <span class="number">400</span>, <span class="number">0</span>, <span class="number">400</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">hilight</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2)</span> </span>&#123;</div><div class="line">	glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</div><div class="line">	glBegin(GL_LINES);</div><div class="line">	glLineWidth(<span class="number">2</span>);</div><div class="line">	glVertex2f(x1, <span class="number">400</span> - y1);</div><div class="line">	glVertex2f(x2, <span class="number">400</span> - y2);</div><div class="line">	glEnd();</div><div class="line">	glFlush();</div><div class="line">&#125;</div><div class="line"><span class="comment">//测试</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LBLineClipTest</span><span class="params">(<span class="keyword">float</span> p, <span class="keyword">float</span> q, <span class="keyword">float</span> &amp;umax, <span class="keyword">float</span> &amp;umin)</span> </span>&#123;</div><div class="line">	<span class="keyword">float</span> r = <span class="number">0.0</span>;</div><div class="line">	<span class="keyword">if</span> (p &lt; <span class="number">0.0</span>) &#123;</div><div class="line">		r = q / p;</div><div class="line">		<span class="keyword">if</span> (r &gt; umin) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (r &gt; umax) &#123;</div><div class="line">			umax = r;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (p &gt; <span class="number">0.0</span>) &#123;</div><div class="line">		r = q / p;</div><div class="line">		<span class="keyword">if</span> (r &lt; umax) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (r &lt; umin) &#123;</div><div class="line">			umin = r;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (q &lt; <span class="number">0.0</span>) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">LBLineClip</span><span class="params">(<span class="keyword">float</span> xwl, <span class="keyword">float</span> xwr, <span class="keyword">float</span> ywb, <span class="keyword">float</span> ywt, <span class="keyword">float</span> x1, <span class="keyword">float</span> y1, <span class="keyword">float</span> x2, <span class="keyword">float</span> y2)</span> </span>&#123;</div><div class="line">	<span class="keyword">float</span> umax, umin, deltax, deltay, xx2, yy2, xx1, yy1;</div><div class="line">	deltax = x2 - x1;</div><div class="line">	deltay = y2 - y1;</div><div class="line">	umax = <span class="number">0.0</span>;</div><div class="line">	umin = <span class="number">1.0</span>;</div><div class="line">	<span class="keyword">if</span> (LBLineClipTest(-deltax, x1 - xwl, umax, umin)) &#123;</div><div class="line">		<span class="keyword">if</span> (LBLineClipTest(deltax, xwr - x1, umax, umin)) &#123;</div><div class="line">			<span class="keyword">if</span> (LBLineClipTest(-deltay, y1 - ywb, umax, umin)) &#123;</div><div class="line">				<span class="keyword">if</span> (LBLineClipTest(deltay, ywt - y1, umax, umin)) &#123;</div><div class="line">					xx1 = <span class="keyword">int</span>(x1 + umax*deltax + <span class="number">0.5</span>);</div><div class="line">					yy1 = <span class="keyword">int</span>(y1 + umax*deltay + <span class="number">0.5</span>);</div><div class="line">					xx2 = <span class="keyword">int</span>(x1 + umin*deltax + <span class="number">0.5</span>);</div><div class="line">					yy2 = <span class="keyword">int</span>(y1 + umin*deltay + <span class="number">0.5</span>);</div><div class="line">				&#125;</div><div class="line">				hilight(xx1, yy1, xx2, yy2);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">myDisplay</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	glFlush();</div><div class="line">&#125;</div><div class="line"><span class="comment">//鼠标事件</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnMouse</span><span class="params">(<span class="keyword">int</span> button, <span class="keyword">int</span> state, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	drawRect();</div><div class="line">	<span class="keyword">if</span> (button == GLUT_LEFT_BUTTON&amp;&amp;state == GLUT_DOWN) &#123;</div><div class="line">		<span class="keyword">if</span> (f % <span class="number">2</span> == <span class="number">0</span>) &#123;</div><div class="line">			f++;</div><div class="line">			S[<span class="number">0</span>] = x; S[<span class="number">1</span>] = y;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			f++;</div><div class="line">			S[<span class="number">2</span>] = x; S[<span class="number">3</span>] = y;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	glBegin(GL_POINTS);<span class="comment">//画点  </span></div><div class="line">	glVertex2f(S[<span class="number">0</span>], <span class="number">400</span> - S[<span class="number">1</span>]);</div><div class="line">	glEnd();</div><div class="line">	glBegin(GL_POINTS);<span class="comment">//画点  </span></div><div class="line">	glVertex2f(S[<span class="number">2</span>], <span class="number">400</span> - S[<span class="number">3</span>]);</div><div class="line">	glEnd();</div><div class="line">	<span class="comment">//画线</span></div><div class="line">	glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);</div><div class="line">	glBegin(GL_LINES);</div><div class="line">	glLineWidth(<span class="number">2</span>);</div><div class="line">	glVertex2f(S[<span class="number">0</span>], <span class="number">400</span> - S[<span class="number">1</span>]);</div><div class="line">	glVertex2f(S[<span class="number">2</span>], <span class="number">400</span> - S[<span class="number">3</span>]);</div><div class="line">	glEnd();</div><div class="line">	glFlush();</div><div class="line">	LBLineClip(StartX, StartX + Width, StartY, StartY + Height, S[<span class="number">0</span>], S[<span class="number">1</span>], S[<span class="number">2</span>], S[<span class="number">3</span>]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	glutInit(&amp;argc, argv);   <span class="comment">//初始化GLUT</span></div><div class="line">	glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);</div><div class="line">	glutInitWindowPosition(<span class="number">500</span>, <span class="number">200</span>);</div><div class="line">	glutInitWindowSize(<span class="number">400</span>, <span class="number">400</span>);</div><div class="line">	glutCreateWindow(<span class="string">"LB"</span>);</div><div class="line">	drawRect();</div><div class="line">	InitEnvironment();   <span class="comment">//初始化</span></div><div class="line">	glutMouseFunc(&amp;OnMouse);  <span class="comment">//注册鼠标事件</span></div><div class="line">	glutDisplayFunc(&amp;myDisplay);   <span class="comment">//回调函数 </span></div><div class="line">	glutMainLoop();    <span class="comment">//持续显示，当窗口改变会重新绘制图形</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行结果：<br><img src="/img/LB.png" alt="LB"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/02/18/函数/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://Persuingsdu.github.io">Persuing</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>