<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 计算机图形学实验集 · Persuing</title><meta name="description" content="计算机图形学实验集 - Persuing"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://Persuingsdu.github.io/atom.xml" title="Persuing"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/test/" target="_self" class="nav-list-link">PHOTO</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">计算机图形学实验集</h1><div class="post-info">Apr 1, 2018</div><div class="post-content"><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><p><strong>1.实验一：</strong>在窗口画三个不同的图形（平面图形即可），通过鼠标选择能分别进行交互，控制它们平移缩放旋转。<br>需要解决的问题：<br>1.利用鼠标、键盘进行交互。<br>2.<a href="https://blog.csdn.net/hgl868/article/details/7947272" target="_blank" rel="external">如何判断点在多边形内。</a><br>3.如何计算出平移、缩放、旋转之后点的坐标。<br>代码：<br><figure class="highlight c++"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;gl\glut.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_VERTEX 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_PLOY 3</span></div><div class="line"><span class="keyword">int</span> clickX, clickY;</div><div class="line"><span class="keyword">int</span> moveNum = <span class="number">-1</span>;<span class="comment">//定义移动的哪个</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">polygon</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> x[MAX_VERTEX];</div><div class="line">	<span class="keyword">int</span> y[MAX_VERTEX];</div><div class="line">	<span class="keyword">int</span> verNum;</div><div class="line">	GLubyte color[<span class="number">3</span>];</div><div class="line">&#125;;</div><div class="line">polygon* polygons = <span class="keyword">new</span> polygon[MAX_PLOY];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</div><div class="line">	polygons[<span class="number">0</span>].x[<span class="number">0</span>] = <span class="number">6</span>; polygons[<span class="number">0</span>].y[<span class="number">0</span>] = <span class="number">63</span>;</div><div class="line">	polygons[<span class="number">0</span>].x[<span class="number">1</span>] = <span class="number">119</span>; polygons[<span class="number">0</span>].y[<span class="number">1</span>] = <span class="number">95</span>;</div><div class="line">	polygons[<span class="number">0</span>].x[<span class="number">2</span>] = <span class="number">37</span>; polygons[<span class="number">0</span>].y[<span class="number">2</span>] = <span class="number">6</span>;</div><div class="line">	polygons[<span class="number">0</span>].verNum = <span class="number">3</span>;</div><div class="line">	polygons[<span class="number">1</span>].x[<span class="number">0</span>] = <span class="number">350</span>; polygons[<span class="number">1</span>].y[<span class="number">0</span>] = <span class="number">95</span>;</div><div class="line">	polygons[<span class="number">1</span>].x[<span class="number">1</span>] = <span class="number">190</span>; polygons[<span class="number">1</span>].y[<span class="number">1</span>] = <span class="number">100</span>;</div><div class="line">	polygons[<span class="number">1</span>].x[<span class="number">2</span>] = <span class="number">200</span>; polygons[<span class="number">1</span>].y[<span class="number">2</span>] = <span class="number">150</span>;</div><div class="line">	polygons[<span class="number">1</span>].x[<span class="number">3</span>] = <span class="number">380</span>; polygons[<span class="number">1</span>].y[<span class="number">3</span>] = <span class="number">200</span>;</div><div class="line">	polygons[<span class="number">1</span>].verNum = <span class="number">4</span>;</div><div class="line">	polygons[<span class="number">2</span>].x[<span class="number">0</span>] = <span class="number">200</span>; polygons[<span class="number">2</span>].y[<span class="number">0</span>] = <span class="number">200</span>;</div><div class="line">	polygons[<span class="number">2</span>].x[<span class="number">1</span>] = <span class="number">180</span>; polygons[<span class="number">2</span>].y[<span class="number">1</span>] = <span class="number">300</span>;</div><div class="line">	polygons[<span class="number">2</span>].x[<span class="number">2</span>] = <span class="number">300</span>; polygons[<span class="number">2</span>].y[<span class="number">2</span>] = <span class="number">260</span>;</div><div class="line">	polygons[<span class="number">2</span>].verNum = <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">glPolygons</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAX_PLOY; i++) &#123;</div><div class="line">		polygon poly = polygons[i];</div><div class="line">		glBegin(GL_LINE_LOOP);</div><div class="line">		<span class="keyword">int</span> num = poly.verNum;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; num; j++) </div><div class="line">			glVertex2d(poly.x[j] , <span class="number">400</span> - poly.y[j]);</div><div class="line">		glEnd();</div><div class="line">		glFlush();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//判断多边形是否在内部</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">pointInPoly</span><span class="params">(polygon poly, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> nCross = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; poly.verNum; i++) &#123;</div><div class="line">		<span class="keyword">int</span> p1x = poly.x[i];</div><div class="line">		<span class="keyword">int</span> p1y = poly.y[i];</div><div class="line">		<span class="keyword">int</span> p2x = poly.x[(i + <span class="number">1</span>) % poly.verNum];</div><div class="line">		<span class="keyword">int</span> p2y = poly.y[(i + <span class="number">1</span>) % poly.verNum];</div><div class="line">		<span class="comment">// 平行或在延长线上，忽略 </span></div><div class="line">		<span class="keyword">if</span> (p1y == p2y || y &lt; min(p1y, p2y) || y &gt; max(p1y, p2y)) &#123;</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// 计算交点横坐标 </span></div><div class="line">		<span class="keyword">double</span> m = (<span class="keyword">double</span>)(y - p1y) * (<span class="keyword">double</span>)(p2x - p1x) / (<span class="keyword">double</span>)(p2y - p1y) + p1x;</div><div class="line">		<span class="keyword">if</span> (m &gt; x) nCross++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> (nCross % <span class="number">2</span> == <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">//移动多边形</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">movePoly</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="comment">// 取到要移动的图形 </span></div><div class="line">	<span class="keyword">int</span> verNum = polygons[moveNum].verNum;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; verNum; i++) &#123;</div><div class="line">		polygons[moveNum].x[i] += (x - clickX);</div><div class="line">		polygons[moveNum].y[i] += (y - clickY);</div><div class="line">	&#125;</div><div class="line">	clickX = x;</div><div class="line">	clickY = y;</div><div class="line">	glutPostRedisplay();<span class="comment">//更新</span></div><div class="line">	<span class="comment">//glPolygons(); //拖动带有阴影效果</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//绕定点(Rx,Ry)旋转theate角度</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotatePoly</span><span class="params">(<span class="keyword">int</span> Rx, <span class="keyword">int</span> Ry, <span class="keyword">double</span> theate)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> verNum = polygons[moveNum].verNum;</div><div class="line">	GLfloat tempt;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; verNum; i++) &#123;</div><div class="line">		tempt = Rx + (polygons[moveNum].x[i] - Rx)*<span class="built_in">cos</span>(theate) - (polygons[moveNum].y[i] - Ry)*<span class="built_in">sin</span>(theate);</div><div class="line">		polygons[moveNum].y[i] = Ry + (polygons[moveNum].x[i] - Rx)*<span class="built_in">sin</span>(theate) + (polygons[moveNum].y[i] - Ry)*<span class="built_in">cos</span>(theate);</div><div class="line">		polygons[moveNum].x[i] = tempt;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//glPolygons();</span></div><div class="line">	glutPostRedisplay();</div><div class="line">&#125;</div><div class="line"><span class="comment">//按定点(Rx,Ry)进行缩放</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">scalePoly</span><span class="params">(<span class="keyword">int</span> Rx, <span class="keyword">int</span> Ry, <span class="keyword">double</span> sx, <span class="keyword">double</span> sy)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> verNum = polygons[moveNum].verNum;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; verNum; i++) &#123;</div><div class="line">		polygons[moveNum].x[i] = polygons[moveNum].x[i] * sx + Rx*(<span class="number">1</span> - sx);</div><div class="line">		polygons[moveNum].y[i] = polygons[moveNum].y[i] * sy + Ry*(<span class="number">1</span> - sy);</div><div class="line">	&#125;</div><div class="line">	glutPostRedisplay();</div><div class="line">&#125;</div><div class="line"><span class="comment">//鼠标点击事件</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnMouse</span><span class="params">(<span class="keyword">int</span> button, <span class="keyword">int</span> state, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	clickX = x;</div><div class="line">	clickY = y;</div><div class="line">	<span class="keyword">if</span> (button == GLUT_LEFT_BUTTON&amp;&amp;state == GLUT_DOWN) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAX_PLOY; i++)</div><div class="line">			<span class="keyword">if</span> (pointInPoly(polygons[i], x, y)) </div><div class="line">				moveNum = i;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//鼠标移动事件</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">moveMouse</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (moveNum != <span class="number">-1</span>)</div><div class="line">		movePoly(x, y);</div><div class="line">&#125;</div><div class="line"><span class="comment">//键盘事件</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">keyPressed</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> key, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">switch</span> (key) &#123;</div><div class="line">	<span class="keyword">case</span> <span class="string">'a'</span>:</div><div class="line">		rotatePoly(polygons[moveNum].x[<span class="number">0</span>], polygons[moveNum].y[<span class="number">0</span>], <span class="number">6</span>);<span class="comment">//逆时针旋转</span></div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">case</span> <span class="string">'d'</span>:</div><div class="line">		rotatePoly(polygons[moveNum].x[<span class="number">0</span>], polygons[moveNum].y[<span class="number">0</span>], <span class="number">-6</span>);<span class="comment">//顺时针旋转</span></div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">case</span> <span class="string">'w'</span>:</div><div class="line">		scalePoly(polygons[moveNum].x[<span class="number">0</span>], polygons[moveNum].y[<span class="number">0</span>], <span class="number">1.1</span>, <span class="number">1.1</span>);<span class="comment">//放大</span></div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">case</span> <span class="string">'s'</span>:</div><div class="line">		scalePoly(polygons[moveNum].x[<span class="number">0</span>], polygons[moveNum].y[<span class="number">0</span>], <span class="number">0.9</span>, <span class="number">0.9</span>);<span class="comment">//缩小</span></div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	glutPostRedisplay();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitEnvironment</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	glClearColor(<span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0</span>);</div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	glPointSize(<span class="number">6</span>);</div><div class="line">	glMatrixMode(GL_MODELVIEW);</div><div class="line">	glLoadIdentity();</div><div class="line">	gluOrtho2D(<span class="number">0</span>, <span class="number">400</span>, <span class="number">0</span>, <span class="number">400</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">	glClear(GL_COLOR_BUFFER_BIT);</div><div class="line">	glPolygons();</div><div class="line">	glFlush();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	glutInit(&amp;argc, argv);   <span class="comment">//初始化GLUT</span></div><div class="line">	glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);</div><div class="line">	glutInitWindowPosition(<span class="number">500</span>, <span class="number">200</span>);</div><div class="line">	glutInitWindowSize(<span class="number">400</span>, <span class="number">400</span>);</div><div class="line">	glutCreateWindow(<span class="string">"LB"</span>);</div><div class="line">	glutMouseFunc(&amp;OnMouse);  <span class="comment">//注册鼠标事件</span></div><div class="line">	glutMotionFunc(&amp;moveMouse);</div><div class="line">	glutKeyboardFunc(&amp;keyPressed);</div><div class="line">	draw();</div><div class="line">	InitEnvironment();   <span class="comment">//初始化</span></div><div class="line">	glutDisplayFunc(&amp;display);   <span class="comment">//回调函数 </span></div><div class="line">	glutMainLoop();    <span class="comment">//持续显示，当窗口改变会重新绘制图形</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>主要参考：<br><a href="https://cuiqingcai.com/?s=OpenGL" target="_blank" rel="external">R1</a><br><a href="https://wenku.baidu.com/view/027513c55fbfc77da269b19b.html" target="_blank" rel="external">R2</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/04/02/CSS学习笔记/" class="prev">PREV</a><a href="/2018/03/31/单源最短路径/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://Persuingsdu.github.io">Persuing</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>